@{
    ViewBag.Title = "Reporte Roles | frmReporteRoles";
    Layout = "~/Views/Shared/_LayoutAdm.cshtml";

    String Opcion = ViewBag.Opcion;
    String Titulo = "";
    String SubTitulo = "";

    switch (Opcion)
    {
        case "ReporteRol":
            Titulo = " REPORTE DE ROLES";
            SubTitulo = "Reporte de Roles";
            break;
        case "AccesoRol":
            Titulo = " REPORTE LOGS DE ACCESO A ROLES";
            SubTitulo = "Reporte de Logs de Acceso a Roles";
            break;
        default:
            Titulo = " REPORTE LOGS DE ACCESO DE USUARIOS";
            SubTitulo = "Reporte Logs de Acceso de Usuarios";
            break;
    }


}

@section styles{
    <link href="~/Content/Validation.css" rel="stylesheet" />
    <link href="~/assets/css/fileinput.css" rel="stylesheet" />
    <link href="~/assets/css/angular-busy.css" rel="stylesheet" />
    <script src="~/Scripts/General/FileSaver.min.js"></script>
    <link href="~/Content/angular-datepicker.css" rel="stylesheet" />

}


<div class="breadcrumbs" id="breadcrumbs" style="top:0px; padding: 0 0 0 0">
    <script type="text/javascript">
        try { ace.settings.check('breadcrumbs', 'fixed') } catch (e) { }
    </script>

    <ul class="breadcrumb">
        <li>
            <i class="ace-icon fa fa-home home-icon"></i>&nbsp;<a href="~/Home/Index">Inicio</a>
        </li>
        <li>
            <i class="ace-icon fa fa-database"></i>
            <a href="~/Home/Index">Seguridad</a>
        </li>

        <li>
            <i class="ace-icon fa fa-calendar"></i>
            <a href="frmReporteSolicitudEtiqueta">@SubTitulo</a>
        </li>
    </ul>
</div>
<body data-ng-controller="frmReporteRolesController">

    @*Session Busqueda*@
    <div class="ace-settings-container" id="ace-settings-container">
        <div class="btn btn-app btn-xs btn-warning ace-settings-btn" id="ace-settings-btn">
            <i class="ace-icon  glyphicon glyphicon-search "></i>
        </div>
        <div class="ace-settings-box clearfix" id="ace-settings-box">



            <div class="container container-fluid" style="padding:0 0 0 0;width:280px;">

                <div class="row">
                    <div class="col-md-4" style="width:15px;">
                        &nbsp;
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 col-xs-12 col-lg-12" style="text-align: right;">
                        <button id="btnConsultaini" type="button" class="btn btn-sm btn-round btn-primary"
                                create-pages results="SolProveedor" number-per-page="10"
                                pages="pagesCho"
                                page-content="pageContentCho;" page-limit="100000" binding="blur"
                                ng-click="Consultar(); showPaginate=true;">
                            <i class=" glyphicon glyphicon-search">
                            </i>
                            Consultar
                        </button>
                    </div>
                </div>

                <div class="row" style="width:15px;">
                    <div class="col-md-4">
                        &nbsp;
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 col-xs-12 col-lg-12 titulos" style="background-color: #006865">
                        <span class="lbl">Criterios de Búsqueda</span>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 col-xs-12 col-lg-12">
                        <br />
                        <span class="lbl">Rango de Fecha</span>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 col-xs-12 col-lg-12">
                        <label>
                            <input type="radio" checked name="TodFechas" class="ace" value="1" id="rbtTodasFechas" ng-model="PorFechas" />
                            <span class="lbl">Todas las Fechas:</span>
                        </label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 col-xs-12 col-lg-12">
                        <label>
                            <input type="radio" name="PorRango" class="ace" value="2" id="rbtRangoFechas" ng-model="PorFechas" />
                            <span class="lbl">Rango:</span>
                        </label>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 col-xs-12 col-lg-12">
                        <br />
                        <label>
                            <span class="lbl">Desde:</span>

                        </label>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 col-xs-12 col-lg-12">
                        <div class="input-group">
                            <input class="form-control date-picker input-mask-date" name="txtfecdesde" id="txtfecdesde" type="text" ng-model="txtfecdesde" maxlength="10" style="width: 100%" placeholder="Desde" data-date-format="dd/mm/yyyy" />
                            <span class=" input-group-addon">
                                <i class="fa fa-calendar small-1"></i>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 col-xs-12 col-lg-12">
                        <br />
                        <span class="lbl">Hasta:</span>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 col-xs-12 col-lg-12">
                        <div class="input-group">
                            <input class="form-control date-picker input-mask-date" name="txtfechasta" id="txtfecdesde" type="text" ng-model="txtfechasta" maxlength="10" style="width: 100%" placeholder="Hasta" data-date-format="dd/mm/yyyy" />
                            <span class=" input-group-addon">
                                <i class="fa fa-calendar small-1"></i>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 col-xs-12 col-lg-12">
                        &nbsp;
                    </div>
                </div>

            </div>


        </div>
    </div>
    @*Fin Session Busqueda*@


    <div cg-busy="{promise:myPromise,message:message,backdrop:true}">
        <div class="widget-box">
            <div class="widget-header" style="text-align:center;text-wrap:none;">
                <h4 class="widget-title"> @Titulo</h4>
                <div class="widget-toolbar">
                    <a href="#" data-action="collapse">
                        <i class="ace-icon fa fa-chevron-up"></i>
                    </a>
                </div>
                <font ng-hide="etiTotRegistros==''" class="widget-toolbar"> Total: {{etiTotRegistros}} Registros </font>
            </div>



            <input ng-init="init()" type="hidden" id="hidOpcion" value=@Opcion />

            <div class="widget-body">
                <div class="widget-main">
                    @*Session Botones*@
                    <div class=" ">
                        <div class=" ">
                            <div class="row">
                                <div class=" col-md-12 ">
                                    <h4 class="smaller" style="text-align:right;">

                                        <button ng-click="exportar(1)" id="btnGrabar" class="btn btn-sm btn-round btn-primary" style="font-size:10pt;">
                                            <i class="fa fa-file-excel-o"></i>
                                            <font>Exportar Excel</font>
                                        </button>

                                    </h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    @*Fin Session Botones*@



                    <div class="widget-body">
                        <div class="widget-main">
                            <div ng-controller="PaginationController">
                                @*<div ng-show="showPaginate">*@
                                <div>
                                    <div id="no-more-tables">
                                        <table class="table table-striped table-bordered table-condensed table-hover gridStyle">
                                            <thead>
                                                <tr>
                                                    <th ng-if="'@Opcion' == 'AccesoRol' || '@Opcion' == 'AccesoUsuario'"
                                                        class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                        <a href="#" ng-click="sortType = 'fecha'; sortReverse = !sortReverse">
                                                            Usuario
                                                            <span ng-show="sortType == 'fecha' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'fecha' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>

                                                    <th ng-if="'@Opcion' == 'AccesoUsuario'"
                                                        class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                        <a href="#" ng-click="sortType = 'codsap'; sortReverse = !sortReverse">
                                                            Transacción
                                                            <span ng-show="sortType == 'codsap' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'codsap' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>

                                                    <th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                        <a href="#" ng-click="sortType = 'nombreproveedor'; sortReverse = !sortReverse">
                                                            Fecha de Registro
                                                            <span ng-show="sortType == 'nombreproveedor' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'nombreproveedor' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>

                                                    <th ng-if="'@Opcion' == 'AccesoUsuario'"
                                                        class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                        <a href="#" ng-click="sortType = 'codsap'; sortReverse = !sortReverse">
                                                            Organización
                                                            <span ng-show="sortType == 'codsap' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'codsap' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>


                                                    <th ng-if="'@Opcion' == 'ReporteRol'"
                                                        class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                        <a href="#" ng-click="sortType = 'numcita'; sortReverse = !sortReverse">
                                                            Rol
                                                            <span ng-show="sortType == 'numcita' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'numcita' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>

                                                    <th ng-if="'@Opcion' == 'ReporteRol'"
                                                        class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                        <a href="#" ng-click="sortType = 'codsap'; sortReverse = !sortReverse">
                                                            Descripción
                                                            <span ng-show="sortType == 'codsap' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'codsap' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>



                                                    <th ng-if="'@Opcion' == ''"
                                                        class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                        <a href="#" ng-click="sortType = 'codsap'; sortReverse = !sortReverse">
                                                            Aplicativo
                                                            <span ng-show="sortType == 'codsap' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'codsap' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>



                                                    <th ng-if="'@Opcion' == 'AccesoRol'"
                                                        class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                        <a href="#" ng-click="sortType = 'horainicial'; sortReverse = !sortReverse">
                                                            Acción
                                                            <span ng-show="sortType == 'horainicial' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'horainicial' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>

                                                    <th ng-if="'@Opcion' == ''"
                                                        class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                        <a href="#" ng-click="sortType = 'horafinal'; sortReverse = !sortReverse">
                                                            Opción
                                                            <span ng-show="sortType == 'horafinal' && !sortReverse" class="fa fa-caret-down"></span>
                                                            <span ng-show="sortType == 'horafinal' && sortReverse" class="fa fa-caret-up"></span>
                                                        </a>
                                                    </th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="content in pageContentCho">

                                                    <td ng-if="'@Opcion' == 'AccesoRol' || '@Opcion' == 'AccesoUsuario'"
                                                        style="font-size:11px;text-align:center" data-title="usuario">
                                                        {{content.usuario}}
                                                    </td>

                                                    <td ng-if="'@Opcion' == 'AccesoUsuario'"
                                                        style="font-size:11px;text-align:center" data-title="Transaccion">
                                                        {{content.descTransaccion}}
                                                    </td>

                                                    <td style="font-size:11px;text-align:center" data-title="fecha Registro">
                                                        {{content.fecha}}
                                                    </td>

                                                    <td ng-if="'@Opcion' == 'AccesoUsuario'"
                                                        style="font-size:11px;text-align:center" data-title="Organizacion">
                                                        {{content.descOrganizacion}}
                                                    </td>



                                                    <td ng-if="'@Opcion' == 'ReporteRol'"
                                                        style="font-size:11px;text-align:center" data-title="rol">
                                                        {{content.rol}}
                                                    </td>
                                                    <td ng-if="'@Opcion' == 'ReporteRol'"
                                                        style="font-size:11px;text-align:center" data-title="descripcion">
                                                        {{content.descripcion}}
                                                    </td>

                                                    <td ng-if="'@Opcion' == ''"
                                                        style="font-size:11px;text-align:center" data-title="Aplicativo">
                                                        {{content.descAplicativo}}
                                                    </td>

                                                    <td ng-if="'@Opcion' == 'AccesoRol'"
                                                        style="font-size:11px;text-align:center" data-title="accion">
                                                        {{content.accion}}
                                                    </td>

                                                    <td ng-if="'@Opcion' == ''"
                                                        style="font-size:11px;text-align:center" data-title="opcion">
                                                        {{content.opcion}}
                                                    </td>

                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <p> {{pagesCo.length}}</p>

                                    <ul style="position: relative;" class="pagination" ng-hide="pagesCho.length==0">

                                        <li pagination ng-class="[{active: page == getCurrentPage()}, {disabled: isFirstPage()} ]  " page="1">
                                            <a><div class="glyphicon glyphicon-fast-backward"></div></a>
                                        </li>
                                        <li ng-class="{disabled: isFirstPage()}" pagination-left><a><div class="glyphicon glyphicon-backward"></div></a></li>
                                        <li>
                                            <a> {{getCurrentPage()}} </a> <a>de</a> <a> {{pagesCho.length}}</a>
                                        </li>
                                        <li ng-class="{disabled: isLastPage()}" pagination-right><a><div class="glyphicon glyphicon-forward"></div></a></li>
                                        <li pagination ng-class="[{active: page == getCurrentPage()}, {disabled: isLastPage()} ]  " page="{{pagesCho.length}}">
                                            <a><div class="glyphicon glyphicon-fast-forward"></div></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        @Html.Partial("_mensajeConfirmado")
        @Html.Partial("_mensajeError")
        @Html.Partial("_mensajeConfirmacion")


    </div>

</body>
@section scripts{
    <script type="text/javascript">
        $(document).ready(function () {
            //esto funciona bien, pero se ha elegido otro datepicker
            //$("#txtFecha").datepicker("option", "dateFormat", 'dd-mm-yyyy');
            //$("#txtFechaIni").datepicker("option", "dateFormat", 'dd-mm-yyyy');
            //$("#txtFechaFin").datepicker("option", "dateFormat", 'dd-mm-yyyy');

        });
        $('.date-picker').datepicker({
            minDate: new Date(1999, 10 - 1, 25),
            maxDate: '+30Y',
            autoclose: true,
            todayHighlight: true
        })
            //show datepicker when clicking on the icon
            .next().on(ace.click_event, function () {
                $(this).prev().focus();
            });
        $('.input-mask-date').mask('99/99/9999');

    </script>

}




