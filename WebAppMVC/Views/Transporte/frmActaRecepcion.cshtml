@{
    ViewBag.Title = "Reporte Acta Recepcion Pedido";
    Layout = "~/Views/Shared/_LayoutPrivado.cshtml";
}
@section styles{
    <link href="~/Content/Validation.css" rel="stylesheet" />
    <link href="~/assets/css/fileinput.css" rel="stylesheet" />
    <link href="~/assets/css/angular-busy.css" rel="stylesheet" />

<link href="~/Content/angular-datepicker.css" rel="stylesheet" />
<link href="~/assets/css/angular-busy.css" rel="stylesheet" />

}
@using WebAppMVC.Helper
<div style="height :100%; width:100%; font-size:12px;zoom:100%;">
    <div class="breadcrumbs" id="breadcrumbs" style="top:0px;">
        <script type="text/javascript">
            try { ace.settings.check('breadcrumbs', 'fixed') } catch (e) { }
        </script>

        <ul class="breadcrumb">
            <li>
                <i class="ace-icon fa fa-home home-icon"></i>&nbsp;<a href="~/Notificacion/frmVisualizaNotificaciones">Inicio</a>
            </li>
            <li>
                <i class="ace-icon fa fa-truck"></i>
                <a href="~/Home/IndexPrivado">Logística</a>
            </li>

            <li>
                <i class="ace-icon fa fa-folder-open"></i>
                <a href="frmReporteUsuarioNoIngreso">Consulta de Actas</a>
            </li>
        </ul><!-- /.breadcrumb -->
        <!-- #section:basics/content.searchbox -->
        <!-- /section:basics/content.searchbox -->
    </div>
</div>
<body data-ng-controller="ReporteActaRecepcionController" @Html.RequestVerificationToken()>
    <div style="height :100%; width:100%; font-size:12px;zoom:100%;">
        @*Session Busqueda*@
        <div style="height:100%;">
            <div class="ace-settings-container" id="ace-settings-container">
                <div class="btn btn-app btn-xs btn-warning ace-settings-btn open" id="ace-settings-btn">
                    <i class="ace-icon  glyphicon glyphicon-search bigger-130"></i>
                </div>
                <div class="ace-settings-box clearfix open" id="ace-settings-box">
                    <div class="container container-fluid" style="padding:0 0 0 0">
                        <div class="row">
                            <div class="col-md-3" style="text-align: right;">
                                <button type="button" id="btnConsulta1" class="btn btn-sm btn-round"
                                        style="background-color:rgb(238,37,34)!important;border-color:rgb(238,37,34)!important;"
                                        create-pages results="resDgConsulta" number-per-page="30" pages="pagesCo"
                                        page-content="pageContentCo;" page-limit="9000" binding="blur"
                                        ng-click="Consultar(); showPaginate=true;">
                                    <i class="glyphicon glyphicon-search"></i>
                                    Consultar
                                </button>
                            </div>
                        </div>
                        <div>
                            <div class="row">
                                <div class="col-md-4 titulos">
                                    <span class="lbl" style="font-family:Arial;font-size:12px;font-weight:bold">Parámetros</span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-2 ">
                                    <label>
                                        <input type="radio" name="FiltrosGrupo1" class="ace form-control" id="rbtPorRango" ng-model="pOpcGrp1" value="P" />
                                        <span class="lbl">Datos</span>
                                    </label>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label>
                                        <span class="lbl">Número Orden:</span>
                                    </label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <input type="text" id="txtsap" class="form-control" ng-model="txtorden" placeholder="Número Orden" style=" width: 100%" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label>
                                        <span class="lbl">Factura:</span>
                                    </label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <input type="text" id="txtusuario" class="form-control" ng-model="txtfactura" placeholder="Número Factura" style=" width: 100%" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4 titulos">
                                    <span class="lbl" style="font-family:Arial;font-size:12px;font-weight:bold">Fechas</span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-2 ">
                                    <label>
                                        <input type="radio" name="FiltrosGrupo1" class="ace form-control" id="rbtPorRango" ng-model="pOpcGrp1" value="R" />
                                        <span class="lbl">Rango de Fecha</span>
                                    </label>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-md-1 ">
                                    <label>
                                        <span class="lbl">Desde:</span>
                                    </label>
                                </div>
                                <div class="col-md-2 ">
                                    <div class="input-group">

                                        @*<input type="date" id="txtFechaIni" ng-model="pFechaIni" maxlength="10" placeholder="Fecha Inicial" class="form-control" style="width:90%" />*@
                                        <input class="form-control date-picker input-mask-date" id="txtFechaIni" type="text" ng-model="pFechaIni" maxlength="10" placeholder="Fecha Inicial" data-date-format="dd/mm/yyyy" />
                                        <span class=" input-group-addon">
                                            <i class="fa fa-calendar small-1"></i>
                                        </span>
                                    </div>

                                </div>

                            </div>

                            <div class="row">
                                <div class="col-md-1 ">
                                    <label>
                                        <span class="lbl">Hasta:</span>
                                    </label>
                                </div>
                                <div class="col-md-2 ">
                                    <div class="input-group">

                                        @*<input type="date" id="txtFechaIni" ng-model="pFechaIni" maxlength="10" placeholder="Fecha Inicial" class="form-control" style="width:90%" />*@
                                        <input class="form-control date-picker input-mask-date" id="txtFechaFin" type="text" ng-model="pFechaFin" maxlength="10" placeholder="Fecha Final" data-date-format="dd/mm/yyyy" />
                                        <span class=" input-group-addon">
                                            <i class="fa fa-calendar small-1"></i>
                                        </span>
                                    </div>
                                    @*<input type="date" id="txtFechaFin" ng-model="pFechaFin" maxlength="10" placeholder="Fecha Final" class="form-control" style="width:90%" />*@
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4 titulos">
                                    <span class="lbl">Estado</span>
                                </div>
                            </div>
                            <br />
                            <div class="row">

                                <div class="col-md-1">
                                    <label>
                                        <span class="lbl">Estado:</span>
                                    </label>
                                </div>
                                <div class="col-md-2">
                                    <label>
                                        <select class="chosen-select form-control" id="cmbestado" ng-model="cmbestado"
                                                ng-options="item as item.detalle for item in cmbestadoActas"></select>
                                    </label>
                                </div>

                            </div>
                            &nbsp;
                        </div>
                    </div>
                </div>
            </div>
            @*Fin Session Busqueda*@
        </div>
        <div cg-busy="{promise:myPromise,message:message,backdrop:true}">
            <div class="widget-box">
                <div class="widget-header" style="text-align:center;text-wrap:none;">
                    <h4 class="widget-title">CONSULTA DE ACTAS DE ENTREGA/RECEPCIÓN</h4>
                    <div class="widget-toolbar">
                        <a href="#" data-action="collapse">
                            <i class="ace-icon fa fa-chevron-up"></i>
                        </a>
                    </div>
                    <font ng-hide="etiTotRegistros==''" class="widget-toolbar"> Total: {{etiTotRegistros}} Registros </font>
                </div>

                <div class="widget-body">
                    <div class="widget-main">
                        @*Session Botones*@
                        @*<div class="widget-box">
                            <div class="widget-header">
                                <div class="row">
                                    <div class=" col-md-12 ">
                                        <h4 class="smaller" style="text-align:right;">
                                            <button type="button" class="btn btn-sm btn-round" style="background-color:rgb(238,37,34)!important;border-color:rgb(238,37,34)!important" ng-click="exportar(1)">
                                                <i class="fa fa-file-excel-o "></i>
                                                Exportar XLS
                                            </button>
                                            <button type="button" class="btn btn-sm btn-round" style="background-color:rgb(238,37,34)!important;border-color:rgb(238,37,34)!important" ng-click="exportar(2)">
                                                <i class="fa fa-file-pdf-o"></i>
                                                Exporta PDF
                                            </button>
                                        </h4>
                                    </div>
                                </div>
                            </div>
                        </div>*@
                        @*Fin Session Botones*@
                        <div class="widget-body">
                            <div class="widget-main">
                                <div ng-controller="PaginationController">
                                    <div ng-show="showPaginate">
                                        <div id="no-more-tables">
                                            <table class="table table-striped table-bordered table-condensed table-hover gridStyle">
                                                <thead>
                                                    <tr>
                                                       
                                                        <th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                            <a href="#" ng-click="sortType = 'noOrden'; sortReverse = !sortReverse">
                                                                Número de Orden
                                                                <span ng-show="sortType == 'noOrden' && !sortReverse" class="fa fa-caret-down"></span>
                                                                <span ng-show="sortType == 'noOrden' && sortReverse" class="fa fa-caret-up"></span>
                                                            </a>
                                                        </th>
                                                        <th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                            <a href="#" ng-click="sortType = 'noFactura'; sortReverse = !sortReverse">
                                                                Número Factura
                                                                <span ng-show="sortType == 'noFactura' && !sortReverse" class="fa fa-caret-down"></span>
                                                                <span ng-show="sortType == 'noFactura' && sortReverse" class="fa fa-caret-up"></span>
                                                            </a>
                                                        </th>
                                                        <th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                            <a href="#" ng-click="sortType = 'almacen'; sortReverse = !sortReverse">
                                                                Almacén
                                                                <span ng-show="sortType == 'almacen' && !sortReverse" class="fa fa-caret-down"></span>
                                                                <span ng-show="sortType == 'almacen' && sortReverse" class="fa fa-caret-up"></span>
                                                            </a>
                                                        </th>
                                                        <th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                            <a href="#" ng-click="sortType = 'ciudad'; sortReverse = !sortReverse">
                                                                Ciudad
                                                                <span ng-show="sortType == 'ciudad' && !sortReverse" class="fa fa-caret-down"></span>
                                                                <span ng-show="sortType == 'ciudad' && sortReverse" class="fa fa-caret-up"></span>
                                                            </a>
                                                        </th>
                                                        <th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                            <a href="#" ng-click="sortType = 'anio'; sortReverse = !sortReverse">
                                                                Año
                                                                <span ng-show="sortType == 'anio' && !sortReverse" class="fa fa-caret-down"></span>
                                                                <span ng-show="sortType == 'anio' && sortReverse" class="fa fa-caret-up"></span>
                                                            </a>
                                                        </th>
                                                        <th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                            <a href="#" ng-click="sortType = 'mes'; sortReverse = !sortReverse">
                                                                Mes
                                                                <span ng-show="sortType == 'mes' && !sortReverse" class="fa fa-caret-down"></span>
                                                                <span ng-show="sortType == 'mes' && sortReverse" class="fa fa-caret-up"></span>
                                                            </a>
                                                        </th>
                                                        <th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                            <a href="#" ng-click="sortType = 'dia'; sortReverse = !sortReverse">
                                                                Día
                                                                <span ng-show="sortType == 'dia' && !sortReverse" class="fa fa-caret-down"></span>
                                                                <span ng-show="sortType == 'dia' && sortReverse" class="fa fa-caret-up"></span>
                                                            </a>
                                                        </th>
                                                        <th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                            <a href="#" ng-click="sortType = 'archivo'; sortReverse = !sortReverse">
                                                                Nombre de Archivo
                                                                <span ng-show="sortType == 'archivo' && !sortReverse" class="fa fa-caret-down"></span>
                                                                <span ng-show="sortType == 'archivo' && sortReverse" class="fa fa-caret-up"></span>
                                                            </a>
                                                        </th>
                                                        <th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                            <a href="#" ng-click="sortType = 'estado'; sortReverse = !sortReverse">
                                                                Estado
                                                                <span ng-show="sortType == 'estado' && !sortReverse" class="fa fa-caret-down"></span>
                                                                <span ng-show="sortType == 'estado' && sortReverse" class="fa fa-caret-up"></span>
                                                            </a>
                                                        </th>
 							<th class="grid-header uppercase info" style="font-size:11px;text-align:center">
                                                            <a href="#" ng-click="sortType = 'archivo'; sortReverse = !sortReverse">
                                                                Descargar
                                                                <span ng-show="sortType == 'archivo' && !sortReverse" class="fa fa-caret-down"></span>
                                                                <span ng-show="sortType == 'archivo' && sortReverse" class="fa fa-caret-up"></span>
                                                            </a>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr ng-repeat="content in pageContentCo  | orderBy:sortTypeCon:sortReverse">
                                                      
                                                        <td style="font-size:11px;text-align:center" data-title="N° ORDEN">{{content.noOrden}}</td>
                                                        <td style="font-size:11px;text-align:center"data-title="N° FACTURA">{{content.noFactura}}</td>
                                                        <td style="font-size:11px;"data-title="ALMACEN">{{content.almacen}}</td>
                                                        <td style="font-size:11px;"data-title="CIUDAD">{{content.ciudad}}</td>
                                                        <td style="font-size:11px;text-align:center" data-title="AÑO">{{content.anio}}</td>
                                                        <td style="font-size:11px;text-align:center" data-title="MES">{{content.mes}}</td>
                                                        <td style="font-size:11px;text-align:center" data-title="DIA">{{content.dia}}</td>
                                                       
                                                        <td style="font-size:11px;"data-title="ARCHIVO"><a href="#" ng-click="descargaArchivo(content)">{{content.archivo}}</a></td>
                                                      
                                                        <td style="font-size:11px;" data-title="Estado" class="clsForeColor{{content.estado}}">{{content.desEstado}}</td>

                                                        <td style="font-size:smaller;text-align:center" data-title="DESCARGAR">
                                                                    <button type="button" class="btn btn-danger btn-minier" ng-click="descargaArchivo(content);">
                                                                        <span class="fa fa-download"></span>
                                                                    </button>

                                                                </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <ul style="position: relative;" class="pagination" ng-hide="pagesCo.length==0">

                                            <li pagination ng-class="[{active: page == getCurrentPage()}, {disabled: isFirstPage()} ]  " page="1">
                                                <a><div class="glyphicon glyphicon-fast-backward"></div></a>
                                            </li>
                                            <li ng-class="{disabled: isFirstPage()}" pagination-left><a><div class="glyphicon glyphicon-backward"></div></a></li>
                                            <li>
                                                <a> {{getCurrentPage()}} </a> <a>de</a> <a> {{pagesCo.length}}</a>
                                            </li>
                                            <li ng-class="{disabled: isLastPage()}" pagination-right><a><div class="glyphicon glyphicon-forward"></div></a></li>
                                            <li pagination ng-class="[{active: page == getCurrentPage()}, {disabled: isLastPage()} ]  " page="{{pagesCo.length}}">
                                                <a><div class="glyphicon glyphicon-fast-forward"></div></a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>



            @Html.Partial("_mensajeConfirmado")
            @Html.Partial("_mensajeError")
            @Html.Partial("_mensajeConfirmacion")
            @Html.Partial("_mensajeInformativo")
        </div>
    </div>

    @*Session Mensaje Confirmacion*@
    <div class="modal fade" data-backdrop="static" data-keyboard="false" id="idMensajeInformativoActas" tabindex="-1" role="dialog" aria-hidden="true" style="z-index:98;height:100%; width:100%;">
        <div class="modal-dialog" style="height:80%;  top:20%;">
            <div class="modal-content">
                <div class="modal-header" style="text-align:center;">
                    <div @*class="widget-box"*@>
                        <div class="widget-header" style="color:#ffffff; background:#428BCA !important;border-color:#428BCA !important;height:36px">
                            <div class="col-md-1">
                                <button style="background:#428BCA!important;border-color:#428BCA !important" class="btn   btn-danger btn-xs">
                                    <i class="ace-icon fa fa-info-circle bigger-200"></i>
                                </button>
                            </div>
                            <div class="col-md-10">
                                <h4 class="white text-primary bigger-125">
                                    Mensaje Informativo
                                </h4>
                            </div>
                            <div class="col-md-1">

                            </div>

                        </div>
                    </div>
                </div>
                <div class="modal-body" style="  max-height: 70%; overflow-y: auto;">
                    <div class="panel-body">
                        <br />
                        <center>
                            <label>
                                <span class="lbl"><b>{{MenjError}} <u style="font-size:20px">ANULADA</u></b></span>
                            </label>
                        </center>
                        <br />
                    </div>

                </div>
                <div class="modal-footer">
                    <div style="text-align:center;">
                        <button type="button" class="btn btn-primary btn-sm " data-dismiss="modal" id="btnConsulta" ng-click="descargaArchivo2()">
                            <i class="ace-icon fa fa-check"></i>
                            Aceptar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @*Fin Session Mensaje Confirmacion*@

</body>
@section scripts{
    <script src="~/assets/js/fileinput.js"></script>
    <script src="~/assets/js/fileinput.min.js"></script>
    <script src="../assets/js/chosen.jquery.js"></script>
    <script src="~/Scripts/General/FileSaver.min.js"></script>
<script src="~/Scripts/General/FileSaver.min.js"></script>
<script src="~/Scripts/datetimepicker.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        //esto funciona bien, pero se ha elegido otro datepicker
        //$("#txtFecha").datepicker("option", "dateFormat", 'dd-mm-yyyy');
        //$("#txtFechaIni").datepicker("option", "dateFormat", 'dd-mm-yyyy');
        //$("#txtFechaFin").datepicker("option", "dateFormat", 'dd-mm-yyyy');

    });
    $('.date-picker').datepicker({
        minDate: new Date(1999, 10 - 1, 25),
        maxDate: '+30Y',
        autoclose: true,
        todayHighlight: true
    })
            //show datepicker when clicking on the icon
            .next().on(ace.click_event, function () {
                $(this).prev().focus();
            });
    $('.input-mask-date').mask('99/99/9999');

    //webshims.setOptions('waitReady', false);
    //webshims.setOptions('forms-ext', { types: 'date' });
    //webshims.polyfill('forms forms-ext');
    //$.webshims.formcfg = {
    //    en: {
    //        dFormat: '/',
    //        dateSigns: '/',
    //        patterns: {
    //            d: "dd/mm/yy"
    //        }
    //    }
    //};

    //$.webshims.activeLang('en');


</script>
<style type="text/css">
    /*estilos para rows especiales del grid*/
    .clsForeColorA {
        font-weight: bold;
    }

    .clsForeColorX {
        font-weight: bold;
        text-decoration: underline;
    }
</style>


}




